<!-- 图书馆管理系统设计文档模板 -->

# 图书馆管理系统设计文档

## 1. 数据结构设计

### 1.1 图书节点

```c
typedef struct Book {
    char isbn[20];
    char title[100];
    char author[50];
    int stock;
    int loaned;
    struct Book* next;
} BookNode;
```

-   **ISBN 格式**：符合国际标准（13 位数字，如 9787532781234）
-   **链表特性**：单向链表，头插法实现

### 1.2 借阅记录

```c
typedef struct {
    char isbn[20];
    int quantity;
    time_t timestamp;
} LoanLog;
```

-   **持久化格式**：二进制文件`loan.bin`
-   **时间记录**：使用`time_t`类型，可转换为可读时间
-   **导出格式**：CSV 文件`loan.csv`

### 1.3 书籍信息

```json
{
	"metadata": {
		"version": "1.0",
		"created": "1726704000"
	},
	"books": [
		{
			"isbn": "9787532781234",
			"title": "三体",
			"author": "刘慈欣",
			"stock": 5,
			"loaned": 3
		},
		{
			"isbn": "9787532782345",
			"title": "流浪地球",
			"author": "刘慈欣",
			"stock": 2,
			"loaned": 1
		}
	]
}
```

-   **持久化格式**：JSON 文件`books.json`
-   **元数据**：包含版本和创建时间，便于未来格式升级
-   **可读性**：格式化输出，便于人工查看
-   **完整性**：包含所有业务所需字段（包括`loaned`）

## 2. 模块划分

| 模块    | 职责               | 依赖     |
| ------- | ------------------ | -------- |
| `data`  | 数据容器操作       | 无       |
| `logic` | 业务逻辑处理       | `data`   |
| `store` | 文件 I/O 操作      | `data`   |
| `main`  | 用户界面和命令解析 | 所有模块 |

## 3. 小组分工

| 成员     | 负责模块 | 具体任务                                  |
| -------- | -------- | ----------------------------------------- |
| [新干 A] | `data`   | 实现`add_book`和`destroy_list`            |
| [新干 B] | `data`   | 实现`search_by_isbn`和`search_by_keyword` |
| [新干 C] | `logic`  | 实现`sort_by_stock`和`sort_by_loan`       |
| [现干]   | 所有     | 指导、代码审查、集成测试                  |

## 4. 关键算法设计

### 4.1 快速排序实现

### 4.2 模糊搜索

### 4.3 JSON 解析

## 5. 风险与应对

| 风险          | 影响       | 应对措施               |
| ------------- | ---------- | ---------------------- |
| 内存泄漏      | 程序崩溃   | 使用 Valgrind 定期检测 |
| 链表操作错误  | 数据丢失   | 单元测试覆盖边界情况   |
| 文件 I/O 失败 | 数据不一致 | 增加错误处理和日志     |
